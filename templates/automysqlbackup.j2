# By default, the Debian version of automysqlbackup will use:
# mysqldump --defaults-file=/etc/mysql/debian.cnf
# but you might want to overwrite with a specific user & pass.
# To do this, simply edit bellow.

# Username to access the MySQL server e.g. dbuser
#USERNAME=`grep user /etc/mysql/debian.cnf | tail -n 1 | cut -d"=" -f2 | awk '{print $1}'`



# Username to access the MySQL server e.g. password
#PASSWORD=`grep password /etc/mysql/my.cnf | tail -n 1 | cut -d"=" -f2 | awk '{print $1}'`

# Host name (or IP address) of MySQL server e.g localhost
DBHOST={{ automysqlbackup_dbhost }}

# List of DBNAMES for Daily/Weekly Backup e.g. "DB1 DB2 DB3"
# Note that it's absolutely normal that the db named "mysql" is not in this
# list, as it's added later by the script. See the MDBNAMES directives below
# in this file (advanced options).
# This is ONLY a convenient default, if you don't like it, don't complain
# and write your own.
# The following is a quick hack that will find the names of the databases by
# reading the mysql folder content. Feel free to replace by something else.
# DBNAMES=`find /var/lib/mysql -mindepth 1 -maxdepth 1 -type d | cut -d'/' -f5 | grep -v ^mysql\$ | tr \\\r\\\n ,\ `
# This one does a list of dbs using a MySQL statement.
DBNAMES=`mysql --defaults-file=/etc/mysql/debian.cnf --execute="SHOW DATABASES" | awk '{print $1}' | grep -v ^Database$ | grep -v ^mysql$ | grep -v ^performance_schema$ | grep -v ^information_schema$ | tr \\\r\\\n ,\ `

# Backup directory location e.g /backups
# Folders inside this one will be created (daily, weekly, etc.), and the
# subfolders will be database names. Note that backups will be owned by
# root, with Unix rights 0600.
BACKUPDIR="{{ automysqlbackup_backupdir }}"

# Mail setup
# What would you like to be mailed to you?
# - log   : send only log file
# - files : send log file and sql files as attachments (see docs)
# - stdout : will simply output the log to the screen if run manually.
# - quiet : Only send logs if an error occurs to the MAILADDR.
MAILCONTENT="{{ automysqlbackup_mailcontent }}"

# Set the maximum allowed email size in k. (4000 = approx 5MB email [see
# docs])
MAXATTSIZE="{{ automysqlbackup_maxattsize }}"

# Email Address to send mail to? (user@domain.com)
MAILADDR="{{ automysqlbackup_mailaddr }}"

# ============================================================
# === ADVANCED OPTIONS ( Read the doc's below for details )===
#=============================================================

# List of DBBNAMES for Monthly Backups.
MDBNAMES="{{ automysqlbackup_mdbnames }}"
# List of DBNAMES to EXLUCDE if DBNAMES are set to all (must be in " quotes)
DBEXCLUDE="{{ automysqlbackup_dbexclude }}"

# Include CREATE DATABASE in backup?
CREATE_DATABASE={{ automysqlbackup_create_database }}

# Separate backup directory and file for each DB? (yes or no)
SEPDIR={{ automysqlbackup_sepdir }}

# Which day do you want weekly backups? (1 to 7 where 1 is Monday)
DOWEEKLY={{ automysqlbackup_doweekly }}

# Choose Compression type. (gzip or bzip2)
COMP={{ automysqlbackup_comp }}

# Compress communications between backup server and MySQL server?
COMMCOMP={{ automysqlbackup_commcomp }}

# Additionally keep a copy of the most recent backup in a seperate
# directory.
LATEST={{ automysqlbackup_latest }}

#  The maximum size of the buffer for client/server communication. e.g. 16MB
#  (maximum is 1GB)
MAX_ALLOWED_PACKET={{ automysqlbackup_max_allowed_packet }}

#  For connections to localhost. Sometimes the Unix socket file must be
#  specified.
SOCKET={{ automysqlbackup_socket }}

{% if automysqlbackup_prebackup is defined %}
PREBACKUP={{ automysqlbackup_prebackup | default("/etc/mysql-backup-pre") }}
{% endif %}

{% if automysqlbackup_postbackup is defined %}
POSTBACKUP={{ automysqlbackup_postbackup | default("/etc/mysql-backup-post") }}
{% endif %}


# Backup of stored procedures and routines (comment to remove)
ROUTINES={{ automysqlbackup_routines }}
